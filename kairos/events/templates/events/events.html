{% extends 'layout.html' %}

{% block title %}
    Events
{% endblock %}


{% block content %}
    <div x-data="eventsComponent()" class="container mx-auto max-w-[1200px] px-8">

        <div class="max-h-fit flex my-16 space-x-4 md:flex-row flex-col gap-y-4 md:gap-0">
            <input @keydown.enter="loadEvents();" class=" rounded-lg w-full md:w-2/3" id="search" name="search" type="text" placeholder="Search Event"  />
            
            <div class="relative inline-block text-left">
                <!-- Dropdown Button -->
                <button id="dropdownButton" type="button" class="bg-secondary text-white px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-400 ">
                    Filter (alphabetical) â†‘
                </button>

                <!-- Dropdown Menu -->
                <div id="dropdownMenu" class="hidden absolute mt-2 md:w-56 rounded-md shadow-lg bg-secondary text-white z-10">
                    <div class="py-1">
                    <a href="#" class="block px-4 py-2 hover:bg-primary-200">Alphabetical</a>
                    <a href="#" class="block px-4 py-2 hover:bg-primary-200">Most Recent</a>
                    <a href="#" class="block px-4 py-2 hover:bg-primary-200">Most Popular</a>
                    </div>
                </div>
            </div>
            
        </div>

        <div class="max-h-[50vh] overflow-y-scroll space-y-8 pr-4">
          {% if events %}
            {% for event in events %}
            <div class="flex items-start gap-4 p-4 bg-white rounded-xl shadow-sm w-full max-w-xl">
    
              <!-- Event icon / image placeholder -->
              <div class="w-16 h-16 bg-gray-200 rounded-xl flex items-center justify-center">
                  <span class="text-gray-500 text-xl">ðŸ“…</span>
              </div>
          
              <!-- Text content -->
              <div>
                  <h2 class="text-xl font-semibold">{{ event.title }}</h2>
                  <p class="text-gray-600">{{ event.body }}</p>
          
                  <p class="text-sm text-gray-400 mt-1">
                      {{ event.date }}
                  </p>
          
                  <a href="{% url 'events:event_detail' event.id %}" 
                     class="text-primary-200 font-semibold text-sm mt-2 inline-block hover:underline">
                      View Details â†’
                  </a>
              </div>
          </div>
          
            {% endfor %}
          {% else %}
            <div class="text-gray-500 text-center py-4">
              No events found. Create one in the admin panel.
            </div>
          {% endif %}
        </div>
    </div>

    <script>
      const eventsComponent = () => ({
        async loadEvents() {
          console.log("Inside load events!");

          const res = await fetch('/events/', {method: 'GET', headers: {'X-CSRFToken': csrfToken} });
          //if (res.ok) {
           //   const data = await res.json();
           //   console.log("notifications recieved", data);
           //   this.notifications = data;
          //} else {
          //    console.error('failed to load notifications');
         // }
        }
      });
    </script>
    
    </div>

{% endblock %}


